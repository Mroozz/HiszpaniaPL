<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kalendarz Firebase</title>
    <link href='https://cdn.jsdelivr.net/npm/fullcalendar@5.10.1/main.min.css' rel='stylesheet' />
    <script src='https://cdn.jsdelivr.net/npm/fullcalendar@5.10.1/main.min.js'></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore.js"></script>
    <style>
        #calendar {
            max-width: 900px;
            margin: 40px auto;
        }
    </style>
</head>
<body>
    <div id="calendar"></div>

    <script>
        // Your Firebase configuration (replace with your actual config)
        const firebaseConfig = {
  apiKey: "AIzaSyBOdr5bDRwsZCXOjlX_TVXFNEnVA0w812Q",
  authDomain: "esnieru.firebaseapp.com",
  databaseURL: "https://esnieru-default-rtdb.europe-west1.firebasedatabase.app",
  projectId: "esnieru",
  storageBucket: "esnieru.appspot.com",
  messagingSenderId: "523836156102",
  appId: "1:523836156102:web:5dc41e61790291edfa8fc7"
};

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        document.addEventListener('DOMContentLoaded', function() {
            var calendarEl = document.getElementById('calendar');
            var calendar = new FullCalendar.Calendar(calendarEl, {
                initialView: 'dayGridMonth',
                events: function(fetchInfo, successCallback, failureCallback) {
                    db.collection("events").get().then(querySnapshot => {
                        let events = [];
                        querySnapshot.forEach(doc => {
                            events.push({
                                id: doc.id,
                                title: doc.data().title,
                                start: doc.data().start.toDate(),
                                end: doc.data().end.toDate()
                            });
                        });
                        successCallback(events);
                    }).catch(error => {
                        console.error("Error fetching events: ", error);
                        failureCallback(error);
                    });
                },
                editable: true,
                eventAdd: function(event) {
                    db.collection("events").add({
                        title: event.event.title,
                        start: event.event.start,
                        end: event.event.end
                    }).then(docRef => {
                        event.event.setProp('id', docRef.id);
                    }).catch(error => {
                        console.error("Error adding event: ", error);
                    });
                },
                eventChange: function(event) {
                    db.collection("events").doc(event.event.id).update({
                        title: event.event.title,
                        start: event.event.start,
                        end: event.event.end
                    }).catch(error => {
                        console.error("Error updating event: ", error);
                    });
                },
                eventRemove: function(event) {
                    db.collection("events").doc(event.event.id).delete().catch(error => {
                        console.error("Error removing event: ", error);
                    });
                }
            });
            calendar.render();
        });
    </script>
</body>
</html>
